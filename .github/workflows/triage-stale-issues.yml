name: 'Triage: Mark stale issues and PRs'
# Expected triggers: schedule
on:
  workflow_call:
    inputs:
      stale_issue_label:
        description: 'Label to add to stale issues'
        type: string
        required: false
        default: 'stale,needs-triage'
      start_date:
        description: 'Skip stale action for issues/PRs created before this date (ISO 8601)'
        type: string
        required: false
        default: '2024-11-25T00:00:00Z'
      days_before_stale:
        description: 'Number of days before marking as stale'
        type: number
        required: false
        default: 365
      days_before_close:
        description: 'Number of days before closing stale issues (-1 to never close)'
        type: number
        required: false
        default: -1
      days_before_pr_stale:
        description: 'Number of days before marking PRs as stale (-1 to never mark)'
        type: number
        required: false
        default: -1
      exempt_issue_labels:
        description: 'Comma-separated list of labels that exempt issues from being marked stale'
        type: string
        required: false
        default: 'never-stale, help wanted'

permissions:
  issues: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v9
        with:
          stale-issue-label: ${{ inputs.stale_issue_label || 'stale,needs-triage' }}
          start-date: ${{ inputs.start_date || '2024-11-25T00:00:00Z' }}
          days-before-stale: ${{ inputs.days_before_stale || 365 }}
          days-before-close: ${{ inputs.days_before_close || -1 }}
          days-before-pr-stale: ${{ inputs.days_before_pr_stale || -1 }}
          exempt-issue-labels: ${{ inputs.exempt_issue_labels || 'never-stale, help wanted' }}
